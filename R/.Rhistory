#summon packages
library(dismo)
library(tidyr)
library(maptools)
library(plotly)
library(sp)
library(rgdal)
library(stringr)
library(readr)
library(dplyr)
library(maps)
library(mapdata)
library(raster)
library(elevatr)
#-------------------------------------------------------------------------------------
#Plan.R
files <- list.files(path="C:/Users/12094/Desktop/apENM/data", pattern = "^hf147-1(.*).csv$", full.names = TRUE)
Data <- sapply(files, read.csv, simplify=FALSE) %>% bind_rows(.id = "id") %>%
select(latitude, longitude, ant.genus, ant.species, date) %>%
as.data.frame() %>% na.omit() %>% filter(ant.genus=="Aphaenogaster") %>%
select(-ant.genus) %>% separate(date, c('Month', 'Day', 'Year'),'/')
Data[1822,c("Month", "Day", "Year")]<-  c(03,08,1878)
Data[1823, c("Month", "Day", "Year")]<- c(03,08,1878)
Data[1824, c("Month", "Day", "Year")]<- c(04,29,1889)
Data[1825, c("Month", "Day", "Year")]<- c(05,10,1896)
Data[1826, c("Month", "Day", "Year")]<- c(05,01,1898)
Data[1827, c("Month", "Day", "Year")]<- c(05,01,1898)
Data[1828, c("Month", "Day", "Year")]<- c(07,14,1899)
Data <- transform(Data, Year = as.numeric(Year))
Data$Year_Bin <- cut(Data$Year, 29)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=5) +
theme(lengend.position=c(0.80, 0.85),
legend.background = element_rect(colour = "grey")) +
panel.background = element_rect(fill = "black") +
labs(x="longitude", y="latitude")
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=5)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
min(Data$Year)
min(Data$Year)-max(Data$Year)
141/10
Data$Year_Bin <- cut(Data$Year, 14)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 10)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 29)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 20)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 17)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 15)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 12)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 13)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 14)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 15)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 15)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 10)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
aph_hist <- ggplot(Data, aes(x=Year)) +
geom_histogram(binwidth = 5, fill="darkcyan", col="Black", size=1, alpha=0.65) +
theme(panel.background = element_rect(fill="darkseagreen1")) +
labs(title = "Aphaenogaster Observations", y="Number of Observations")
Data$Year_Bin <- cut(Data$Year, 15)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
Data$Year_Bin <- cut(Data$Year, 7)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
141/5
Data$Year_Bin <- cut(Data$Year, 28)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2)
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2) +
labs(title="Aphaenogaster Sampling Distribution by Year")
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2) +
labs(title="Aphaenogaster Sampling Distribution by Year") +
scale_colour_manual(name="Year Range")
ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2) +
labs(title="Aphaenogaster Sampling Distribution by Year")
data.loess <- loess(Year ~ longitude * latitude, data = Data)
sampling_distribution_yr = ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2) +
labs(title="Aphaenogaster Sampling Distribution by Year")
sampling_distribution_yr
xgrid <-  seq(min(Data$longitude), max(Data$longitude), 0.5)
ygrid <-  seq(min(Data$latitude), max(Data$latitude), 0.5)
data.fit <-  expand.grid(longitude = xgrid, latitude = ygrid)
mtrx3d <-  predict(data.loess, newdata = data.fit)
contour(x = xgrid, y = ygrid, z = mtrx3d)
contour(x = xgrid, y = ygrid, z = mtrx3d, xlab="longitude")
contour(x = xgrid, y = ygrid, z = mtrx3d, xlab="longitude", ylab="latitude")
library(dismo)
library(tidyr)
library(maptools)
library(plotly)
library(sp)
library(rgdal)
library(stringr)
library(readr)
library(dplyr)
library(maps)
library(mapdata)
library(raster)
library(elevatr)
#-------------------------------------------------------------------------------------
#Plan.R
files <- list.files(path="C:/Users/12094/Desktop/apENM/data", pattern = "^hf147-1(.*).csv$", full.names = TRUE)
Data <- sapply(files, read.csv, simplify=FALSE) %>% bind_rows(.id = "id") %>%
select(latitude, longitude, ant.genus, ant.species, date) %>%
as.data.frame() %>% na.omit() %>% filter(ant.genus=="Aphaenogaster") %>%
select(-ant.genus) %>% separate(date, c('Month', 'Day', 'Year'),'/')
Data[1822,c("Month", "Day", "Year")]<-  c(03,08,1878)
Data[1823, c("Month", "Day", "Year")]<- c(03,08,1878)
Data[1824, c("Month", "Day", "Year")]<- c(04,29,1889)
Data[1825, c("Month", "Day", "Year")]<- c(05,10,1896)
Data[1826, c("Month", "Day", "Year")]<- c(05,01,1898)
Data[1827, c("Month", "Day", "Year")]<- c(05,01,1898)
Data[1828, c("Month", "Day", "Year")]<- c(07,14,1899)
Data <- transform(Data, Year = as.numeric(Year))
Data$Year_Bin <- cut(Data$Year, 28)
sampling_distribution_yr = ggplot(Data, aes(x=longitude, y=latitude, color=factor(Year_Bin))) +
geom_point(shape=16, size=2) +
labs(title="Aphaenogaster Sampling Distribution by Year")
data.loess <- loess(Year ~ longitude * latitude, data = Data)
xgrid <-  seq(min(Data$longitude), max(Data$longitude), 0.5)
ygrid <-  seq(min(Data$latitude), max(Data$latitude), 0.5)
data.fit <-  expand.grid(longitude = xgrid, latitude = ygrid)
mtrx3d <-  predict(data.loess, newdata = data.fit)
contour(x = xgrid, y = ygrid, z = mtrx3d, xlab="longitude", ylab="latitude")
HEAD(mtrx3d)
head(mtrx3d)
colnames(mtrx3d)
mtrx.melt <- melt(mtrx3d, id.vars = c(“longitude”, “latitude”), measure.vars =(“Year_Bin”))
mtrx.melt <- melt(mtrx3d, id.vars = c('longitude' , 'latitude'), measure.vars =('Year_Bin'))
mtrx.melt <- melt(mtrx3d, id.vars = c('longitude' , 'latitude'), measure.vars =('Year_Bin'))
head(mtrx3d)
#install.packages("rgdal")
#install.packages("rJava")
#install.packages("maptools")
#install.packages("readr")
#install.packages("maps")
#install.packages("mapdata")
#install.packages("elevatr")
#install.packages("rasterVis")
#install.packages("scales")
#install.packages("rgeos")
install.packages("reshape2")
library(reshape2)
mtrx.melt <- melt(mtrx3d, id.vars = c('longitude' , 'latitude'), measure.vars =('Year_Bin'))
head(mtrx.melt)
names(mtrx.melt) <- c('longitude', 'latitude', 'Year_Bin')
head(mtrx.melt)
str_locate(mtrx.melt$longitude, “=”)
str_locate(mtrx.melt$longitude, '=')
str_locate(mtrx.melt$longitude, '=')[1,1] + 1
mtrx.melt$longitude <- as.numeric(str_sub(mtrx.melt$longitude, str_locate(mtrx.melt$longitude, '=')[1,1] + 1))
mtrx.melt$latitude <- as.numeric(str_sub(mtrx.melt$latitude, str_locate(mtrx.melt$latitude, '=')[1,1] + 1))
head(mtrx.melt)
plot1 <- ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour()
plot1
plot1 <- ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(shape=16, size =2)
plot1
plot1 <- ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data)
plot1
plot1 <- ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data, color=Year_Bin)
plot1 <- ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data, color=Data$Year_Bin)
plot1
ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data, color=factor(Year_Bin))
stat_contour() + geom_point(data=Data, aes(color=Data$Year_Bin)
ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data, aes(color=Data$Year_Bin))
ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data, aes(color=Year_Bin))
sampling_distribution_year = ggplot(mtrx.melt, aes(x = longitude, y = latitude, z = Year_Bin)) +
stat_contour() + geom_point(data=Data, aes(color=Year_Bin)) + labs(title='Aphaenogaster ssp. Sampling Distribution by Year')
sampling_distribution_year
aph_hist <- ggplot(Data, aes(x=Year)) +
geom_histogram(binwidth = 5, fill="darkcyan", col="Black", size=1, alpha=0.65) +
theme(panel.background = element_rect(fill="darkseagreen1")) +
labs(title = "Aphaenogaster Observations", y="Number of Observations")
aph_hist
aph_hist <- ggplot(Data, aes(x=Year)) +
geom_histogram(binwidth = 28, fill="darkcyan", col="Black", size=1, alpha=0.65) +
theme(panel.background = element_rect(fill="darkseagreen1")) +
labs(title = "Aphaenogaster Observations", y="Number of Observations")
aph_hist
head(xgrid)
xgrid
ygrid
data.fit
